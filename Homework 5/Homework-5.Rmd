#HOMEWORK 5, 26 ABRIL 2023.
#USAC, MAESTRIA INGENIERIA PARA INDUSTRIA CON ESPECIALIDAD EN CIENCIA DE COMPUTACION.
#CATEDRATICO: MSC ING. EDWIN ESTUARDO ZAPETA GOMEZ.
#CLASE: FUNDAMENTOS DE PROGRAMACION Y SCRIPTING.
#ALUMNO: GERMAN CONTRERAS JACINTO.
```{r}
library(tidyverse)
library(dplyr)
```
# CARGUE CADA DATA SET DE DATOS Y NOMBRELO SEGUN CADA ARCHIVO
```{r}
questions<-read.csv("questions.csv")
answers<-read.csv("answers.csv")
tags<-read.csv("tags.csv")
question_tags<-read.csv("question_tags.csv")
questions
answers
tags
question_tags
```
#1. LEFT JOINING QUESTIONS AND TAGS
#1.1 RELACIONE QUESTIONS Y QUESTIONS_TAGS USANDO LAS COLUMNAS ID Y QUESTION_ID
```{r}
questions
question_tags

questions %>%
  left_join(question_tags,by=c("id"="question_id"))
```
#1.2 AGREGUE UNA RELACION MAS PARA LA TABLA TAGS
```{r}
questions
tags
questions%>%
  left_join(question_tags,by=c("id"="question_id"))%>%
  left_join(tags, by="id")
```
#1.3 UTILICE REPLACE_NA PARA CAMBIAR LOS NA EN LA COLUMNA TAG_NAME A "ONLY-R"
```{r}
questions%>%
  left_join(question_tags,by=c("id"="question_id"))%>%
  left_join(tags, by="id")%>%
  replace_na(list(tag_name="only-r"))

```
#1.4 POR ULTIMO, ALMACENE EL RESULTADO EN LA VARIABLE QUESTIONS_WITH_TAGS
```{r}
questions_with_tags <- questions%>%
  left_join(question_tags,by=c("id"="question_id"))%>%
  left_join(tags, by="id")%>%
  replace_na(list(tag_name="only-r"))
questions_with_tags
```
#2 COMPARING SCORES ACROSS TAGS
#2.1 UTILICE QUESTIONS_TAGS Y APLIQUE GROUP_BY PARA LA VARIABLE TAG_NAME
```{r}
questions_with_tags%>%
  group_by(tag_name)
```
#2.2 APLIQUE SUMMARIZE PARA OBTENER EL SCORE PROMEDIO DE CADA PREGUNTA Y ASIGNELE
#EL NOMBRE MEAN_SCORE
```{r}
questions_with_tags%>%
  group_by(id)%>%
  summarize(mean_score=mean(score))

```
#2.3 ORDENE MEAN_SCORE EN FORMA DESCENDENTE
```{r}
questions_with_tags%>%
  group_by(id)%>%
  summarize(mean_score=mean(score))%>%
  arrange(desc(mean_score))
```

#3 FINDING GAPTS BETWEEN QUESTIONS AND ANSWERS
#3.1 UTILICE INNER_JOIN PARA COMBINAR LAS TABLAS QUESTIONS AND ANSWERS, 
#LUEGO APLIQUE LOS SUFIJOS "_QUESTIONS" Y "_ANSWER", RESPECTIVAMENTE
```{r}

questions%>%
  inner_join(answers,by=c("id"="question_id"), suffix=c("_questions","_answer"))
```
#3.2 AGREGUE UNA NUEVA COLUMNA UTILIZANDO LA FUNCION MUTATE. LA NUEVA COLUMNA SE LLAMARA
#GAP Y CONTENDRA LA RESTA DE CREATION_DATE_ANSWER Y CREATION_DATE_QUESTION
```{r}
questions%>%
  inner_join(answers,by=c("id"="question_id"), suffix=c("_questions","_answer"))%>%
  mutate(gap = as.Date(creation_date_answer) - as.Date(creation_date_questions))
```
#4 JOINNING QUESTION AND ANSWER COUNTS
#4.1 CUENTE Y ORDENE LA COLUMNA QUESTION_ID EN LA TABLA ANSWERS,
#LUEGO ALMACENE EL RESULTADO EN LA VARIABLE ANSWER_COUNTS
```{r}
answers
answer_counts <-answers%>%
count(question_id, sort = TRUE)
answer_counts
```
#4.2 RELACIONE LA TABLA QUESTIONS CON ANSWER_COUNTS (UTILICE LEFT_JOIN)
```{r}
questions%>%
left_join(answer_counts,by=c("id"="question_id"))
```
#4.3 REEMPLACE LOS VALORES NA EN LA COLUMNA N CON CEROS
```{r}
questions%>%
left_join(answer_counts,by=c("id"="question_id"))%>%
replace_na(list(n=0))

```
#4.4 POR ULTIMO ALMACENE EL RESULTADO EN LA VARIABLAE QUESTION_ANSWER_COUNTS
```{r}
question_answer_counts <-questions%>%
left_join(answer_counts,by=c("id"="question_id"))%>%
replace_na(list(n=0))
question_answer_counts
```
#5 JOINNING QUESTIONS, ANSWERS AND TAGS
#5.1 COMBINE QUESTION_TAGS CON QUESTION_ANSWER_COUNTS USANDO INNER JOIN
```{r}
question_tags%>%
  inner_join(question_answer_counts,by=c("question_id"="id"))
             
```
#5.2 AHORA, USE OTRO INNER_JOIN PARA AGREGAR LA TABLA TAGS.
```{r}
tags
question_tags%>%
  inner_join(question_answer_counts,by=c("question_id"="id"))%>%
  inner_join(tags, by=c("tag_id"="id"))
```
